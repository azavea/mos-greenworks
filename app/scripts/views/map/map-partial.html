<div class="view-map">
    <header>
        <nav class="navbar navbar-default navbar-map">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" ui-sref="home">
                        <img src="/images/branding-greenworks-inverted.svg" alt="">
                    </a>
                </div>
                <div id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav navbar-right">
                        <form role="search" class="navbar-form navbar-left">
                            <location-search on-result-found="map.onSearchResult"></location-search>
                        </form>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="filters">
        <div class="filter-menu" ng-click="map.showFilters = !map.showFilters">
            <div class="filter-header clearfix">
                <div class="filter-header-icon">
                    <div class="filter-header-icon-container">
                        <button type="button" class="filter-toggle vertical-align">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>
                </div>
                <div class="filter-header-heading vertical-align">Filters</div>
                <div class="filter-header-button vertical-align" ng-click="$event.stopPropagation()">
                    <span ng-click="map.onResetClicked()">Reset</span> | <span ng-click="map.onClearClicked()">Clear</span>
                </div>
            </div>
        </div>
        <div class="filter-individuals" ng-show="map.showFilters">
            <div class="filter"
                 ng-class="'mode-{{::key | lowercase}}'"
                 ng-repeat="(key, section) in map.categories"
                 ng-show="map.showCategories">
                <div class="filter-header clearfix" ng-click="map.onHeaderClicked(key)">
                    <div class="filter-header-icon">
                        <div class="filter-header-icon-container mode-background">
                            <img class="mode-icon vertical-align" height="30" width="30" ng-src="/images/logo-{{ key | lowercase }}.svg" alt="">
                        </div>
                    </div>
                    <div class="filter-header-heading vertical-align">{{ ::key }}</div>
                    <div class="filter-header-button vertical-align">
                        <i class="fa fa-angle-up button-icon"
                           ng-class="{'fa-angle-up': !map.open[key], 'fa-angle-down': map.open[key]}"></i>
                    </div>
                </div>
                <div class="filter-body" collapse="!map.open[key]">
                    <div class="filter-subcategory" ng-repeat="(projKey, projectCat) in section">
                        <div class="filter-subcategory-header">
                            <div class="filter-category-checkbox">
                                <input ng-checked="map.toggles.project[projKey]"
                                       ng-click="map.onProjectFilterClicked(projKey)"
                                       type="checkbox">
                            </div>
                            <div class="filter-subcategory-heading">{{ ::projKey }}</div>
                        </div>
                        <div class="filter-subcategory-item"
                             ng-repeat="(subKey, count) in projectCat"
                             ng-init="iconUrl = map.iconForCategory(subKey)">
                            <div class="filter-subcategory-checkbox">
                                <input ng-checked="map.toggles.sub[subKey]"
                                       ng-click="map.onSubFilterClicked(subKey)"
                                       type="checkbox">
                            </div>
                            <div class="filter-subcategory-marker">
                                <div class="marker">
                                    <img ng-if="iconUrl" ng-src="{{ ::iconUrl }}">
                                </div>
                            </div>
                            <div class="filter-subcategory-heading">{{ ::subKey }} ({{ ::count }})</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="map" class="explore map"></div>
</div>
